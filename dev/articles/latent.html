<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- upstream: inst/BS5/templates/head.html; pkgdown-version: 2.1.3, fe04924 --><!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 --><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Latent projection predictive feature selection • projpred</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_3-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome 7.0.1 for Bluesky icon --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" referrerpolicy="no-referrer">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Latent projection predictive feature selection">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <!-- upstream: inst/BS5/templates/navbar.html; pkgdown-version: 2.1.3, fe04924 -->
<!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 -->
<nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">


    <a class="navbar-brand me-2" href="../index.html">
      <!-- Add Stan logo -->
      <picture><source type="image/svg+xml" srcset="../logo.svg"><img src="../logo.png" class="stan-logo" alt="Stan blue hex logo"></source></picture>
      projpred
    </a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.9.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Go to homepage"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Other Packages</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-other-packages">
<li><a class="external-link dropdown-item" href="https://mc-stan.org/bayesplot">bayesplot</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/cmdstanr">cmdstanr</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/loo">loo</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/posterior">posterior</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstan">rstan</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstanarm">rstanarm</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstantools">rstantools</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/shinystan">shinystan</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://mc-stan.org/about/">About Stan</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://bsky.app/profile/did:plc:qznndgdnkem2yryu7ipqbpv7" aria-label="Visit our Bluesky profile"><span class="fa fa-brands fa-bluesky"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://discourse.mc-stan.org/" aria-label="Visit our forums"><span class="fa fa-users"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stan-dev/projpred/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Latent projection predictive feature selection</h1>
            
            <h4 data-toc-skip class="date">2025-10-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stan-dev/projpred/blob/master/vignettes/latent.Rmd" class="external-link"><code>vignettes/latent.Rmd</code></a></small>
      <div class="d-none name"><code>latent.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette shows how to use the latent projection predictive
feature selection from <span class="citation">Catalina, Bürkner, and
Vehtari (<a href="#ref-catalina_latent_2021">2021</a>)</span> in
<strong>projpred</strong>. We recommend to read the <a href="https://mc-stan.org/projpred/articles/projpred.html">main
vignette</a> first, as the latent-projection vignette presented here
will skip some of the details explained in the main vignette.</p>
<div class="section level3">
<h3 id="general-idea">General idea<a class="anchor" aria-label="anchor" href="#general-idea"></a>
</h3>
<p>The response families used in GLMs <span class="citation">(<a href="#ref-mccullagh_generalized_1989">McCullagh and Nelder 1989, chap.
2</a>)</span>, GLMMs, GAMs, and GAMMs (in particular, the
<code><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian()</a></code>, the <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial()</a></code>, and the
<code><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson()</a></code> family which are supported by
<strong>projpred</strong>’s traditional projection) may be termed
<em>exponential dispersion (ED)</em> families <span class="citation">(<a href="#ref-jorgensen_exponential_1987">Jørgensen 1987</a>)</span><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;span class="citation"&gt;Jørgensen (&lt;a href="#ref-jorgensen_exponential_1987"&gt;1987&lt;/a&gt;)&lt;/span&gt; himself only
uses the term “exponential dispersion model”, but the discussion for
that article mentions the term “ED [i.e., exponential dispersion]
family”. &lt;span class="citation"&gt;Jørgensen (&lt;a href="#ref-jorgensen_exponential_1987"&gt;1987&lt;/a&gt;)&lt;/span&gt; also introduces
the class of &lt;em&gt;discrete exponential dispersion&lt;/em&gt; families (here
abbreviated by “DED families”), see section &lt;a href="#negbinex"&gt;“Example: Negative binomial distribution”&lt;/a&gt;.&lt;/p&gt;'><sup>1</sup></a>. For a
response family that is not an ED family, the Kullback-Leibler (KL)
divergence minimization problem <span class="citation">(see <a href="#ref-piironen_projective_2020">Piironen, Paasiniemi, and Vehtari
2020</a>)</span> is often not easy to solve analytically (exceptions are
non-ED families that are discrete and have finite support; see the
comment on the augmented-data projection in section <a href="#impl">“Implementation”</a>). In order to bypass this issue, the
latent projection <span class="citation">(<a href="#ref-catalina_latent_2021">Catalina, Bürkner, and Vehtari
2021</a>)</span> solves the KL minimization problem in the predictive
space of the latent predictors<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The latent predictors are also known as the linear
predictors, but “latent” is a more general term than “linear”.&lt;/p&gt;"><sup>2</sup></a> instead of in the predictive space of the
original response values.</p>
<p>To this end, the latent predictor is assumed to have a Gaussian
distribution, since it (i) constitutes a combination of predictor data
and regression parameters which is often linear (in the parameters,
but—less—often also in the predictor data) or at least additive (across
the predictor terms) and (ii) has the complete real line as support.
Furthermore, the Gaussian distribution has the highest differential
entropy among all distributions with two finite moments and with the
real line as support <span class="citation">(see, e.g., <a href="#ref-cover_elements_1991">Cover and Thomas 1991</a>)</span>. In
some cases, e.g., for the probit link, the Gaussian distribution is even
part of the original statistical model. In case of the logit link, the
Gaussian distribution with a standard deviation of 1.6 approximates the
logistic distribution (with a scale parameter of 1).</p>
<p>The assumption of a Gaussian distribution for the latent predictors
makes things a lot easier because it allows us to make use of
<strong>projpred</strong>’s traditional projection.</p>
<p>As illustrated by the Poisson example below, the latent projection
can not only be used for families not supported by
<strong>projpred</strong>’s traditional projection, but it can also be
beneficial for families supported by it.</p>
</div>
<div class="section level3">
<h3 id="impl">Implementation<a class="anchor" aria-label="anchor" href="#impl"></a>
</h3>
<p>To use the latent projection in <strong>projpred</strong>, argument
<code>latent</code> of <code><a href="../reference/extend_family.html">extend_family()</a></code> needs to be set to
<code>TRUE</code>. Since <code><a href="../reference/extend_family.html">extend_family()</a></code> is called by
<code><a href="../reference/refmodel-init-get.html">init_refmodel()</a></code> which in turn is called by
<code><a href="../reference/refmodel-init-get.html">get_refmodel()</a></code> (more precisely, by the
<code><a href="../reference/refmodel-init-get.html">get_refmodel()</a></code> methods) which in turn is called at the
beginning of the top-level functions <code><a href="../reference/project.html">project()</a></code>,
<code><a href="../reference/varsel.html">varsel()</a></code>, and <code><a href="../reference/cv_varsel.html">cv_varsel()</a></code>, it is possible to
pass <code>latent = TRUE</code> from such a top-level function down to
<code><a href="../reference/extend_family.html">extend_family()</a></code> via the ellipsis (<code>...</code>).
However, we recommend to define the reference model object of class
<code>refmodel</code> explicitly (as illustrated in the examples below)
to avoid repetitive and inefficient code<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;If the &lt;code&gt;refmodel&lt;/code&gt;-class object is not defined
explicitly but implicitly by a call to a top-level function such as
&lt;code&gt;&lt;a href="../reference/project.html"&gt;project()&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href="../reference/varsel.html"&gt;varsel()&lt;/a&gt;&lt;/code&gt;, or
&lt;code&gt;&lt;a href="../reference/cv_varsel.html"&gt;cv_varsel()&lt;/a&gt;&lt;/code&gt;, then &lt;code&gt;latent = TRUE&lt;/code&gt; and all other
arguments related to the latent projection need to be set in
&lt;em&gt;each&lt;/em&gt; call to a top-level function.&lt;/p&gt;'><sup>3</sup></a>.</p>
<p>After performing the projection (either as a stand-alone feature via
<code><a href="../reference/project.html">project()</a></code> or embedded in a variable selection via
<code><a href="../reference/varsel.html">varsel()</a></code> or <code><a href="../reference/cv_varsel.html">cv_varsel()</a></code>), the post-processing
(e.g., the estimation of the performance statistics in
<code><a href="../reference/summary.vsel.html">summary.vsel()</a></code>) can be performed on the original response
scale. For this, there are three arguments of
<code><a href="../reference/extend_family.html">extend_family()</a></code> which accept R functions:
<code>latent_ilink</code> (responsible for the inverse-link
transformation from latent scale to response scale),
<code>latent_ll_oscale</code> (responsible for the calculation of
log-likelihood values on response scale), and
<code>latent_ppd_oscale</code> (responsible for drawing from the
(posterior-projection) predictive distribution on response scale). For
some families, these three arguments have internal defaults implemented
natively in <strong>projpred</strong>. These families are listed in the
main vignette (section <a href="https://mc-stan.org/projpred/articles/projpred.html#modtypes">“Supported
types of models”</a>). For all other families, <strong>projpred</strong>
either tries to infer a reasonable function internally (in case of
<code>latent_ilink</code>) or uses a dummy function returning only
<code>NA</code>s (in case of <code>latent_ll_oscale</code> and
<code>latent_ppd_oscale</code>), unless the user supplies custom
functions. When creating a reference model object for a family that
lacks <strong>projpred</strong>’s native support for full response-scale
post-processing, <strong>projpred</strong> will throw messages stating
whether (and which) features will be unavailable unless at least some of
these three arguments are provided by the user. Again, the ellipsis
(<code>...</code>) can be used to pass these arguments from a top-level
function such as <code><a href="../reference/cv_varsel.html">cv_varsel()</a></code> down to
<code><a href="../reference/extend_family.html">extend_family()</a></code>. In the post-processing functions,
response-scale analyses can usually be deactivated by setting argument
<code>resp_oscale</code> to <code>FALSE</code>, with the exception of
<code><a href="../reference/predict.refmodel.html">predict.refmodel()</a></code> and <code><a href="../reference/pred-projection.html">proj_linpred()</a></code> where
arguments <code>type</code> and <code>transform</code> serve this
purpose (see the documentation).</p>
<p>Apart from the arguments mentioned above,
<code><a href="../reference/extend_family.html">extend_family()</a></code> also features the latent-projection
argument <code>latent_y_unqs</code> whose purpose is described in the
documentation.</p>
<p>While the latent projection is an approximate solution to the KL
divergence minimization problem in the original response space<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;More precisely, the latent projection &lt;em&gt;replaces&lt;/em&gt;
the KL divergence minimization problem in the original response space by
a KL divergence minimization problem in the latent space and solves the
latter.&lt;/p&gt;"><sup>4</sup></a>, the
augmented-data projection <span class="citation">(<a href="#ref-weber_projection_2025">Weber, Glass, and Vehtari
2025</a>)</span> gives the exact<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Here, “exact” means apart from approximations and
simplifications which are also undertaken for the traditional
projection.&lt;/p&gt;"><sup>5</sup></a> solution for some non-ED families, namely
those where the response distribution has finite support. However, the
augmented-data projection comes with a higher runtime than the latent
projection. The families currently supported by
<strong>projpred</strong>’s augmented-data projection are also listed in
the main vignette (again section <a href="https://mc-stan.org/projpred/articles/projpred.html#modtypes">“Supported
types of models”</a>).</p>
</div>
</div>
<div class="section level2">
<h2 id="example-poisson-distribution">Example: Poisson distribution<a class="anchor" aria-label="anchor" href="#example-poisson-distribution"></a>
</h2>
<p>In this example, we will illustrate that in case of a family
supported by <strong>projpred</strong>’s traditional projection (here
the <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson()</a></code> family), the latent projection can improve
runtime and results of the variable selection compared to
<strong>projpred</strong>’s traditional projection, at least if the L1
search is used (see argument <code>method</code> of
<code><a href="../reference/varsel.html">varsel()</a></code> and <code><a href="../reference/cv_varsel.html">cv_varsel()</a></code>).</p>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>First, we generate a training and a test dataset with a
Poisson-distributed response:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Number of observations in the training dataset (= number of observations in</span></span>
<span><span class="co"># the test dataset):</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">71</span></span>
<span><span class="co"># Data-generating function:</span></span>
<span><span class="va">sim_poiss</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">nobs</span> <span class="op">=</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">N</span>, <span class="va">ncon</span> <span class="op">=</span> <span class="fl">10</span>, <span class="va">ncats</span> <span class="op">=</span> <span class="fl">4</span>, <span class="va">nnoise</span> <span class="op">=</span> <span class="fl">39</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Regression coefficients for continuous predictors:</span></span>
<span>  <span class="va">coefs_con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">ncon</span><span class="op">)</span></span>
<span>  <span class="co"># Continuous predictors:</span></span>
<span>  <span class="va">dat_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nobs</span> <span class="op">*</span> <span class="va">ncon</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">ncon</span><span class="op">)</span></span>
<span>  <span class="co"># Start linear predictor:</span></span>
<span>  <span class="va">linpred</span> <span class="op">&lt;-</span> <span class="fl">2.1</span> <span class="op">+</span> <span class="va">dat_sim</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">coefs_con</span></span>
<span>  </span>
<span>  <span class="co"># Categorical predictor:</span></span>
<span>  <span class="va">dat_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">dat_sim</span>,</span>
<span>    xcat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">ncats</span>, k <span class="op">=</span> <span class="va">nobs</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="va">ncats</span>, length <span class="op">=</span> <span class="va">nobs</span>,</span>
<span>              labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"cat"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">ncats</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="co"># Regression coefficients for the categorical predictor:</span></span>
<span>  <span class="va">coefs_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">ncats</span><span class="op">)</span></span>
<span>  <span class="co"># Continue linear predictor:</span></span>
<span>  <span class="va">linpred</span> <span class="op">&lt;-</span> <span class="va">linpred</span> <span class="op">+</span> <span class="va">coefs_cat</span><span class="op">[</span><span class="va">dat_sim</span><span class="op">$</span><span class="va">xcat</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Noise predictors:</span></span>
<span>  <span class="va">dat_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    <span class="va">dat_sim</span>,</span>
<span>    xn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nobs</span> <span class="op">*</span> <span class="va">nnoise</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">nnoise</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Poisson response, using the log link (i.e., exp() as inverse link):</span></span>
<span>  <span class="va">dat_sim</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">nobs</span>, lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">linpred</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># Shuffle order of observations:</span></span>
<span>  <span class="va">dat_sim</span> <span class="op">&lt;-</span> <span class="va">dat_sim</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="va">nobs</span><span class="op">)</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span>  <span class="co"># Drop the shuffled original row names:</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">dat_sim</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">dat_sim</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># Generate data:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">300417</span><span class="op">)</span></span>
<span><span class="va">dat_poiss</span> <span class="op">&lt;-</span> <span class="fu">sim_poiss</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">dat_poiss_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat_poiss</span>, <span class="va">N</span><span class="op">)</span></span>
<span><span class="va">dat_poiss_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">dat_poiss</span>, <span class="va">N</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="reference-model">Reference model<a class="anchor" aria-label="anchor" href="#reference-model"></a>
</h3>
<p>Next, we fit the reference model that we consider as the best model
(in terms of predictive performance) that we can construct (here, we
assume that we don’t know about the true data-generating process even
though the dataset was simulated):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/rstanarm/" class="external-link">rstanarm</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Number of regression coefficients:</span></span>
<span><span class="op">(</span> <span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^x"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dat_poiss_train</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<pre><code>[1] 50</code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prior guess for the number of relevant (i.e., non-zero) regression</span></span>
<span><span class="co"># coefficients:</span></span>
<span><span class="va">p0</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="co"># Prior guess for the overall magnitude of the response values, see Table 1 of</span></span>
<span><span class="co"># Piironen and Vehtari (2017, DOI: 10.1214/17-EJS1337SI):</span></span>
<span><span class="va">mu_prior</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="co"># Hyperprior scale for tau, the global shrinkage parameter:</span></span>
<span><span class="va">tau0</span> <span class="op">&lt;-</span> <span class="va">p0</span> <span class="op">/</span> <span class="op">(</span><span class="va">D</span> <span class="op">-</span> <span class="va">p0</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">mu_prior</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span></span>
<span><span class="co"># Set this manually if desired:</span></span>
<span><span class="va">ncores</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span>logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">### Only for technical reasons in this vignette (you can omit this when running</span></span>
<span><span class="co">### the code yourself):</span></span>
<span><span class="va">ncores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">ncores</span>, <span class="fl">2L</span><span class="op">)</span></span>
<span><span class="co">###</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="va">ncores</span><span class="op">)</span></span>
<span><span class="va">refm_fml</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"y"</span>, <span class="st">"~"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"^x"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dat_poiss_train</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  collapse <span class="op">=</span> <span class="st">" + "</span></span>
<span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">refm_fit_poiss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html" class="external-link">stan_glm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">refm_fml</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat_poiss_train</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/priors.html" class="external-link">hs</a></span><span class="op">(</span>global_scale <span class="op">=</span> <span class="va">tau0</span>, slab_df <span class="op">=</span> <span class="fl">100</span>, slab_scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="co">### Only for the sake of speed (not recommended in general):</span></span>
<span>  chains <span class="op">=</span> <span class="fl">2</span>, iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  <span class="co">###</span></span>
<span>  refresh <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.
Running the chains for more iterations may help. See
https://mc-stan.org/misc/warnings.html#bulk-ess</code></pre>
<p>Due to the technical reasons for which we reduced <code>chains</code>
and <code>iter</code> in this vignette, we ignore the bulk-ESS warning
here.</p>
</div>
<div class="section level3">
<h3 id="variable-selection-using-the-latent-projection">Variable selection using the latent projection<a class="anchor" aria-label="anchor" href="#variable-selection-using-the-latent-projection"></a>
</h3>
<p>Within <strong>projpred</strong>, we define the reference model
object explicitly and set <code>latent = TRUE</code> in the
corresponding <code><a href="../reference/refmodel-init-get.html">get_refmodel()</a></code> call (see section <a href="#impl">“Implementation”</a>) so that the latent projection is used
in downstream functions. Since we have a hold-out test dataset
available, we can use <code><a href="../reference/varsel.html">varsel()</a></code> with argument
<code>d_test</code> instead of <code><a href="../reference/cv_varsel.html">cv_varsel()</a></code>. Furthermore, we
measure the runtime to be able to compare it to the traditional
projection’s later:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/projpred/">projpred</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_test_lat_poiss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dat_poiss_test</span>,</span>
<span>  offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat_poiss_test</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat_poiss_test</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="co">### Here, we are not interested in latent-scale post-processing, so we can set</span></span>
<span>  <span class="co">### element `y` to a vector of `NA`s:</span></span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat_poiss_test</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="co">###</span></span>
<span>  y_oscale <span class="op">=</span> <span class="va">dat_poiss_test</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="op">)</span></span>
<span><span class="va">refm_poiss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/refmodel-init-get.html">get_refmodel</a></span><span class="op">(</span><span class="va">refm_fit_poiss</span>, latent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>Since `&lt;refmodel&gt;$dis` will consist of only `NA`s, downstream analyses based on this reference model object won't be able to use log predictive density (LPD) values on latent scale. Furthermore, proj_predict() won't be able to draw from the latent Gaussian distribution.</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time_lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">vs_lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/varsel.html">varsel</a></span><span class="op">(</span></span>
<span>  <span class="va">refm_poiss</span>,</span>
<span>  d_test <span class="op">=</span> <span class="va">d_test_lat_poiss</span>,</span>
<span>  <span class="co">### Only for demonstrating an issue with the traditional projection in the</span></span>
<span>  <span class="co">### next step (not recommended in general):</span></span>
<span>  method <span class="op">=</span> <span class="st">"L1"</span>,</span>
<span>  <span class="co">###</span></span>
<span>  <span class="co">### Only for the sake of speed (not recommended in general):</span></span>
<span>  nclusters_pred <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  <span class="co">###</span></span>
<span>  nterms_max <span class="op">=</span> <span class="fl">14</span>,</span>
<span>  <span class="co">### In interactive use, we recommend not to deactivate the verbose mode:</span></span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="co">###</span></span>
<span>  <span class="co">### For comparability with varsel() based on the traditional projection:</span></span>
<span>  seed <span class="op">=</span> <span class="fl">95930</span></span>
<span>  <span class="co">###</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">time_lat</span><span class="op">)</span></span></code></pre></div>
<pre><code>   user  system elapsed 
  1.104   0.331   1.050 </code></pre>
<p>The message telling that <code>&lt;refmodel&gt;$dis</code> consists
of only <code>NA</code>s will not concern us here because we will only
focus on response-scale post-processing.</p>
<p>In order to decide for a submodel size, we first inspect the
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> results. In contrast to the main vignette where we
used the mean log predictive density (MLPD) as predictive performance
statistic for a <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian()</a></code> family reference model (and
<code><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian()</a></code> submodels), we have a discrete family
(<code><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson()</a></code>) here, so it makes sense to exponentiate the
MLPD to obtain the geometric mean predictive density (GMPD; in case of a
discrete response, the predictive density values are actually predictive
<em>probabilities</em> and hence the GMPD is bounded by 0 and 1). As in
the main vignette, we plot with <code>deltas = TRUE</code> (in case of
the GMPD, this means that the <em>ratio</em> of the submodel GMPD
vs. the reference model GMPD is shown). Via global option
<code>projpred.plot_vsel_size_position</code>, we set argument
<code>size_position</code> of <code><a href="../reference/plot.vsel.html">plot.vsel()</a></code> to
<code>"secondary_x"</code> to make the submodel sizes readable in all of
the plots in this vignette.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>projpred.plot_vsel_size_position <span class="op">=</span> <span class="st">"secondary_x"</span><span class="op">)</span></span>
<span><span class="op">(</span> <span class="va">gg_lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">vs_lat</span>, stats <span class="op">=</span> <span class="st">"gmpd"</span>, deltas <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<p><img src="latent_files/figure-html/plot_vsel_lat-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>Based on this plot, we decide for a submodel size of 11:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">size_decided_lat</span> <span class="op">&lt;-</span> <span class="fl">11</span></span></code></pre></div>
<p>This is also the size that <code><a href="../reference/suggest_size.html">suggest_size()</a></code> would
suggest:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/suggest_size.html">suggest_size</a></span><span class="op">(</span><span class="va">vs_lat</span>, stat <span class="op">=</span> <span class="st">"gmpd"</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 11</code></pre>
<p>In the predictor ranking up to the selected size of 11, we can see
that <strong>projpred</strong> has correctly selected the truly relevant
predictors first and only then the noise predictors:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rk_lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ranking.html">ranking</a></span><span class="op">(</span><span class="va">vs_lat</span><span class="op">)</span></span>
<span><span class="op">(</span> <span class="va">predictors_final_lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rk_lat</span><span class="op">[[</span><span class="st">"fulldata"</span><span class="op">]</span><span class="op">]</span>, <span class="va">size_decided_lat</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<pre><code> [1] "x.4"  "x.6"  "x.10" "x.3"  "x.1"  "x.2"  "x.8"  "x.7"  "xcat" "x.5" 
[11] "x.9" </code></pre>
<p>We will skip post-selection inference here (see the main vignette for
a demonstration of post-selection inference), but note that
<code><a href="../reference/pred-projection.html">proj_predict()</a></code> has argument <code>resp_oscale</code> for
controlling whether to draw from the posterior-projection predictive
distributions on the original response scale (<code>TRUE</code>, the
default) or on latent scale (<code>FALSE</code>) and that analogous
functionality is available in <code><a href="../reference/pred-projection.html">proj_linpred()</a></code> (argument
<code>transform</code>) and <code><a href="../reference/predict.refmodel.html">predict.refmodel()</a></code> (argument
<code>type</code>).</p>
</div>
<div class="section level3">
<h3 id="variable-selection-using-the-traditional-projection">Variable selection using the traditional projection<a class="anchor" aria-label="anchor" href="#variable-selection-using-the-traditional-projection"></a>
</h3>
<p>We will now look at what <strong>projpred</strong>’s traditional
projection would have given. For this, we increase
<code>nterms_max</code> because this will reveal an issue with this
approach:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d_test_trad_poiss</span> <span class="op">&lt;-</span> <span class="va">d_test_lat_poiss</span></span>
<span><span class="va">d_test_trad_poiss</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">d_test_trad_poiss</span><span class="op">$</span><span class="va">y_oscale</span></span>
<span><span class="va">d_test_trad_poiss</span><span class="op">$</span><span class="va">y_oscale</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">time_trad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">vs_trad</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/varsel.html">varsel</a></span><span class="op">(</span></span>
<span>  <span class="va">refm_fit_poiss</span>,</span>
<span>  d_test <span class="op">=</span> <span class="va">d_test_trad_poiss</span>,</span>
<span>  <span class="co">### Only for demonstrating an issue with the traditional projection (not</span></span>
<span>  <span class="co">### recommended in general):</span></span>
<span>  method <span class="op">=</span> <span class="st">"L1"</span>,</span>
<span>  <span class="co">###</span></span>
<span>  <span class="co">### Only for the sake of speed (not recommended in general):</span></span>
<span>  nclusters_pred <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  <span class="co">###</span></span>
<span>  nterms_max <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  <span class="co">### In interactive use, we recommend not to deactivate the verbose mode:</span></span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="co">###</span></span>
<span>  <span class="co">### For comparability with varsel() based on the latent projection:</span></span>
<span>  seed <span class="op">=</span> <span class="fl">95930</span></span>
<span>  <span class="co">###</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">time_trad</span><span class="op">)</span></span></code></pre></div>
<pre><code>   user  system elapsed 
  4.221   0.343   4.170 </code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span> <span class="va">gg_trad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">vs_trad</span>, stats <span class="op">=</span> <span class="st">"gmpd"</span>, deltas <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<p><img src="latent_files/figure-html/post_vs_trad-1.png" width="90%" style="display: block; margin: auto;">
As these results show, the traditional projection takes longer than the
latent projection, although the difference is rather small on absolute
scale (which is due to the fact that the L1 search is already quite
fast). More importantly however, the predictor ranking contains several
noise terms before truly relevant ones, causing the predictive
performance of the reference model not to be reached before submodel
size 28.</p>
</div>
<div class="section level3">
<h3 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h3>
<p>This example showed that the latent projection can be advantageous
also for families supported by <strong>projpred</strong>’s traditional
projection by improving the runtime as well as the results of the
variable selection.</p>
<!-- **Forward search START:** -->
<!-- ```{r} -->
<!-- time_lat_fw <- system.time(vs_lat_fw <- varsel( -->
<!--   refm_poiss, -->
<!--   d_test = d_test_lat_poiss, -->
<!--   ### Only for demonstrating an issue with the traditional projection in the -->
<!--   ### next step (not recommended in general): -->
<!--   # method = "L1", -->
<!--   ### -->
<!--   ### Only for the sake of speed (not recommended in general): -->
<!--   nclusters_pred = 20, -->
<!--   ### -->
<!--   nterms_max = 14, -->
<!--   ### In interactive use, we recommend not to deactivate the verbose mode: -->
<!--   verbose = 0, -->
<!--   ### -->
<!--   ### For comparability with varsel() based on the traditional projection: -->
<!--   seed = 95930 -->
<!--   ### -->
<!-- )) -->
<!-- print(time_lat_fw) -->
<!-- ( gg_lat_fw <- plot(vs_lat_fw, stats = "gmpd", deltas = TRUE) ) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- time_trad_fw <- system.time(vs_trad_fw <- varsel( -->
<!--     refm_fit_poiss, -->
<!--     d_test = d_test_trad_poiss, -->
<!--     ### Only for demonstrating an issue with the traditional projection (not -->
<!--     ### recommended in general): -->
<!--     # method = "L1", -->
<!--     ### -->
<!--     ### Only for the sake of speed (not recommended in general): -->
<!--     nclusters_pred = 20, -->
<!--     ### -->
<!--     nterms_max = 30, -->
<!--     ### In interactive use, we recommend not to deactivate the verbose mode: -->
<!--     verbose = 0, -->
<!--     ### -->
<!--     ### For comparability with varsel() based on the latent projection: -->
<!--     seed = 95930 -->
<!--     ### -->
<!-- )) -->
<!-- print(time_trad_fw) -->
<!-- ( gg_trad_fw <- plot(vs_trad_fw, stats = "gmpd", deltas = TRUE) ) -->
<!-- ``` -->
<!-- **Forward search END** -->
<p>An important point is that we have used L1 search here. In case of
the latent projection, a forward search would have given only slightly
different results. However, in case of the traditional projection, a
forward search would have given markedly better results (in particular,
all of the noise terms would have been selected after the truly relevant
ones). Thus, the conclusions made here for L1 search cannot be
transmitted easily to forward search.</p>
</div>
</div>
<div class="section level2">
<h2 id="negbinex">Example: Negative binomial distribution<a class="anchor" aria-label="anchor" href="#negbinex"></a>
</h2>
<p>In this example, we will illustrate the latent projection in case of
the negative binomial family (more precisely, we will use the
<code><a href="https://mc-stan.org/rstanarm/reference/neg_binomial_2.html" class="external-link">rstanarm::neg_binomial_2()</a></code> family here) which is a family
that is not supported by <strong>projpred</strong>’s traditional
projection<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The negative binomial distribution belongs to the class
of &lt;em&gt;discrete exponential dispersion&lt;/em&gt; families &lt;span class="citation"&gt;(&lt;a href="#ref-jorgensen_exponential_1987"&gt;Jørgensen
1987&lt;/a&gt;)&lt;/span&gt; (here abbreviated by “DED families”). DED families are
closely related to ED families &lt;span class="citation"&gt;(&lt;a href="#ref-jorgensen_exponential_1987"&gt;Jørgensen 1987&lt;/a&gt;)&lt;/span&gt;, but
strictly speaking, the class of DED families is not a subset of the
class of ED families. GitHub issue &lt;a href="https://github.com/stan-dev/projpred/issues/361" class="external-link"&gt;#361&lt;/a&gt; explains
why the “traditional” projection onto a DED-family submodel is currently
not implemented in &lt;strong&gt;projpred&lt;/strong&gt;.&lt;/p&gt;'><sup>6</sup></a>.</p>
<div class="section level3">
<h3 id="data-1">Data<a class="anchor" aria-label="anchor" href="#data-1"></a>
</h3>
<p>We will re-use the data generated above in the Poisson example.</p>
</div>
<div class="section level3">
<h3 id="reference-model-1">Reference model<a class="anchor" aria-label="anchor" href="#reference-model-1"></a>
</h3>
<p>We now fit a reference model with the negative binomial distribution
as response family. For the sake of simplicity, we won’t adjust
<code>tau0</code> to this new family, but in a real-world example, such
an adjustment would be necessary. However, since Table 1 of <span class="citation">Piironen and Vehtari (<a href="#ref-piironen_sparsity_2017">2017</a>)</span> does not list the
negative binomial distribution, this would first require a manual
derivation of the pseudo-variance <span class="math inline">\(\tilde{\sigma}^2\)</span>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">refm_fit_nebin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html" class="external-link">stan_glm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">refm_fml</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/neg_binomial_2.html" class="external-link">neg_binomial_2</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dat_poiss_train</span>,</span>
<span>  prior <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/priors.html" class="external-link">hs</a></span><span class="op">(</span>global_scale <span class="op">=</span> <span class="va">tau0</span>, slab_df <span class="op">=</span> <span class="fl">100</span>, slab_scale <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="co">### Only for the sake of speed (not recommended in general):</span></span>
<span>  chains <span class="op">=</span> <span class="fl">2</span>, iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  <span class="co">###</span></span>
<span>  refresh <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code>Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.
Running the chains for more iterations may help. See
https://mc-stan.org/misc/warnings.html#bulk-ess</code></pre>
<p>Again, we ignore the bulk-ESS warning due to the technical reasons
for which we reduced <code>chains</code> and <code>iter</code> in this
vignette.</p>
</div>
<div class="section level3">
<h3 id="variable-selection-using-the-latent-projection-1">Variable selection using the latent projection<a class="anchor" aria-label="anchor" href="#variable-selection-using-the-latent-projection-1"></a>
</h3>
<p>To request the latent projection with <code>latent = TRUE</code>, we
now need to specify more arguments (<code>latent_ll_oscale</code> and
<code>latent_ppd_oscale</code>; the internal default for
<code>latent_ilink</code> works correctly in this example) which will be
passed to <code><a href="../reference/extend_family.html">extend_family()</a></code><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The suffix &lt;code&gt;_prec&lt;/code&gt; in &lt;code&gt;refm_prec&lt;/code&gt;
stands for “precision” because here, we follow the Stan convention (see
the Stan documentation for the &lt;code&gt;neg_binomial_2&lt;/code&gt; distribution,
the &lt;code&gt;&lt;a href="https://paulbuerkner.com/brms/reference/brmsfamily.html" class="external-link"&gt;brms::negbinomial()&lt;/a&gt;&lt;/code&gt; documentation, and the &lt;a href="https://paulbuerkner.com/brms/" class="external-link"&gt;&lt;strong&gt;brms&lt;/strong&gt;&lt;/a&gt; vignette
&lt;a href="https://paulbuerkner.com/brms/articles/brms_families.html" class="external-link"&gt;“Parameterization
of Response Distributions in brms”&lt;/a&gt;) and prefer the term
&lt;em&gt;precision&lt;/em&gt; parameter for what is denoted by &lt;span class="math inline"&gt;\(\phi\)&lt;/span&gt; there (confusingly, argument
&lt;code&gt;size&lt;/code&gt; in &lt;code&gt;&lt;a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link"&gt;?stats::NegBinomial&lt;/a&gt;&lt;/code&gt;—which is the same
as &lt;span class="math inline"&gt;\(\phi\)&lt;/span&gt; from the Stan notation—is
called the &lt;em&gt;dispersion&lt;/em&gt; parameter there, although the variance is
increased by its reciprocal).&lt;/p&gt;'><sup>7</sup></a>:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">refm_prec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">refm_fit_nebin</span><span class="op">)</span><span class="op">[</span>, <span class="st">"reciprocal_dispersion"</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span><span class="va">latent_ll_oscale_nebin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ilpreds</span>,</span>
<span>                                   <span class="va">dis</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ilpreds</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                   <span class="va">y_oscale</span>,</span>
<span>                                   <span class="va">wobs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y_oscale</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                   <span class="va">cl_ref</span>,</span>
<span>                                   <span class="va">wdraws_ref</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cl_ref</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">y_oscale_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">y_oscale</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ilpreds</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">ilpreds</span><span class="op">)</span>,</span>
<span>                         byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">wobs_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">wobs</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ilpreds</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">ilpreds</span><span class="op">)</span>,</span>
<span>                     byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">refm_prec_agg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cl_agg.html">cl_agg</a></span><span class="op">(</span><span class="va">refm_prec</span>, cl <span class="op">=</span> <span class="va">cl_ref</span>, wdraws <span class="op">=</span> <span class="va">wdraws_ref</span><span class="op">)</span></span>
<span>  <span class="va">ll_unw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">dnbinom</a></span><span class="op">(</span><span class="va">y_oscale_mat</span>, size <span class="op">=</span> <span class="va">refm_prec_agg</span>, mu <span class="op">=</span> <span class="va">ilpreds</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">wobs_mat</span> <span class="op">*</span> <span class="va">ll_unw</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">latent_ppd_oscale_nebin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ilpreds_resamp</span>,</span>
<span>                                    <span class="va">dis_resamp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ilpreds_resamp</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                    <span class="va">wobs</span>,</span>
<span>                                    <span class="va">cl_ref</span>,</span>
<span>                                    <span class="va">wdraws_ref</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cl_ref</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                    <span class="va">idxs_prjdraws</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">refm_prec_agg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cl_agg.html">cl_agg</a></span><span class="op">(</span><span class="va">refm_prec</span>, cl <span class="op">=</span> <span class="va">cl_ref</span>, wdraws <span class="op">=</span> <span class="va">wdraws_ref</span><span class="op">)</span></span>
<span>  <span class="va">refm_prec_agg_resamp</span> <span class="op">&lt;-</span> <span class="va">refm_prec_agg</span><span class="op">[</span><span class="va">idxs_prjdraws</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span>  <span class="va">ppd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">ilpreds_resamp</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">refm_prec_agg_resamp</span>,</span>
<span>                 mu <span class="op">=</span> <span class="va">ilpreds_resamp</span><span class="op">)</span></span>
<span>  <span class="va">ppd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="va">ppd</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ilpreds_resamp</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">ilpreds_resamp</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">ppd</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">refm_nebin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/refmodel-init-get.html">get_refmodel</a></span><span class="op">(</span><span class="va">refm_fit_nebin</span>, latent <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           latent_ll_oscale <span class="op">=</span> <span class="va">latent_ll_oscale_nebin</span>,</span>
<span>                           latent_ppd_oscale <span class="op">=</span> <span class="va">latent_ppd_oscale_nebin</span><span class="op">)</span></span></code></pre></div>
<pre><code>Defining `latent_ilink` as a function which calls `family$linkinv`, but there is no guarantee that this will work for all families. If relying on `family$linkinv` is not appropriate or if this raises an error in downstream functions, supply a custom `latent_ilink` function (which is also allowed to return only `NA`s if response-scale post-processing is not needed).</code></pre>
<pre><code>Since `&lt;refmodel&gt;$dis` will consist of only `NA`s, downstream analyses based on this reference model object won't be able to use log predictive density (LPD) values on latent scale. Furthermore, proj_predict() won't be able to draw from the latent Gaussian distribution.</code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vs_nebin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/varsel.html">varsel</a></span><span class="op">(</span></span>
<span>  <span class="va">refm_nebin</span>,</span>
<span>  d_test <span class="op">=</span> <span class="va">d_test_lat_poiss</span>,</span>
<span>  <span class="co">### Only for the sake of speed (not recommended in general):</span></span>
<span>  method <span class="op">=</span> <span class="st">"L1"</span>,</span>
<span>  nclusters_pred <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  <span class="co">###</span></span>
<span>  nterms_max <span class="op">=</span> <span class="fl">14</span>,</span>
<span>  <span class="co">### In interactive use, we recommend not to deactivate the verbose mode:</span></span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="co">###</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Again, the message telling that <code>&lt;refmodel&gt;$dis</code>
consists of only <code>NA</code>s will not concern us here because we
will only focus on response-scale post-processing. The message
concerning <code>latent_ilink</code> can be safely ignored here (the
internal default based on <code>family$linkinv</code> works correctly in
this case).</p>
<p>Again, we first inspect the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> results to decide for
a submodel size:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span> <span class="va">gg_nebin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">vs_nebin</span>, stats <span class="op">=</span> <span class="st">"gmpd"</span>, deltas <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<p><img src="latent_files/figure-html/plot_vsel_nebin-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>For the decision of the final submodel size, we act as if we
preferred accuracy over sparsity in their trade-off mentioned in the <a href="https://mc-stan.org/projpred/articles/projpred.html#decision-size">main
vignette</a>, so we decide for a submodel size of 11:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">size_decided_nebin</span> <span class="op">&lt;-</span> <span class="fl">11</span></span></code></pre></div>
<p>This is not the size that <code><a href="../reference/suggest_size.html">suggest_size()</a></code> would suggest,
but as mentioned in the main vignette and in the documentation,
<code><a href="../reference/suggest_size.html">suggest_size()</a></code> provides only a quite heuristic decision (so
we stick with our manual decision here):</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/suggest_size.html">suggest_size</a></span><span class="op">(</span><span class="va">vs_nebin</span>, stat <span class="op">=</span> <span class="st">"gmpd"</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 10</code></pre>
<p>As we can see from the predictor ranking included in the plot, our
selected 11 predictor terms lack one truly relevant predictor
(<code>x.9</code>) and include one noise term (<code>xn.29</code>). More
explicitly, our selected predictor terms are:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rk_nebin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ranking.html">ranking</a></span><span class="op">(</span><span class="va">vs_nebin</span><span class="op">)</span></span>
<span><span class="op">(</span> <span class="va">predictors_final_nebin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rk_nebin</span><span class="op">[[</span><span class="st">"fulldata"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                                 <span class="va">size_decided_nebin</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<pre><code> [1] "x.4"   "x.6"   "x.10"  "x.3"   "x.1"   "x.2"   "x.8"   "xn.29" "x.7"  
[10] "xcat"  "x.5"  </code></pre>
<p>Again, we will skip post-selection inference here (see the main
vignette for a demonstration of post-selection inference).</p>
</div>
<div class="section level3">
<h3 id="conclusion-1">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion-1"></a>
</h3>
<p>This example demonstrated how the latent projection can be used for
those families which are neither supported by
<strong>projpred</strong>’s traditional nor by
<strong>projpred</strong>’s augmented-data projection, which reflects
the flexibility of the latent approach.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-catalina_latent_2021" class="csl-entry">
Catalina, Alejandro, Paul Bürkner, and Aki Vehtari. 2021. <span>“Latent
Space Projection Predictive Inference.”</span> <span>arXiv</span>. <a href="https://doi.org/10.48550/arXiv.2109.04702" class="external-link">https://doi.org/10.48550/arXiv.2109.04702</a>.
</div>
<div id="ref-cover_elements_1991" class="csl-entry">
Cover, Thomas M., and Joy A. Thomas. 1991. <em>Elements of Information
Theory</em>. <span>New York, NY, USA</span>: <span>John Wiley &amp;
Sons, Ltd</span>. <a href="https://doi.org/10.1002/0471200611" class="external-link">https://doi.org/10.1002/0471200611</a>.
</div>
<div id="ref-jorgensen_exponential_1987" class="csl-entry">
Jørgensen, Bent. 1987. <span>“Exponential Dispersion Models.”</span>
<em>Journal of the Royal Statistical Society. Series B
(Methodological)</em> 49 (2): 127–62.
</div>
<div id="ref-mccullagh_generalized_1989" class="csl-entry">
McCullagh, P., and J. A. Nelder. 1989. <em>Generalized Linear
Models</em>. 2nd ed. <span>London</span>: <span>Chapman &amp;
Hall</span>.
</div>
<div id="ref-piironen_projective_2020" class="csl-entry">
Piironen, Juho, Markus Paasiniemi, and Aki Vehtari. 2020.
<span>“Projective Inference in High-Dimensional Problems:
<span>Prediction</span> and Feature Selection.”</span> <em>Electronic
Journal of Statistics</em> 14 (1): 2155–97. <a href="https://doi.org/10.1214/20-EJS1711" class="external-link">https://doi.org/10.1214/20-EJS1711</a>.
</div>
<div id="ref-piironen_sparsity_2017" class="csl-entry">
Piironen, Juho, and Aki Vehtari. 2017. <span>“Sparsity Information and
Regularization in the Horseshoe and Other Shrinkage Priors.”</span>
<em>Electronic Journal of Statistics</em> 11 (2): 5018–51. <a href="https://doi.org/10.1214/17-EJS1337SI" class="external-link">https://doi.org/10.1214/17-EJS1337SI</a>.
</div>
<div id="ref-weber_projection_2025" class="csl-entry">
Weber, Frank, Änne Glass, and Aki Vehtari. 2025. <span>“Projection
Predictive Variable Selection for Discrete Response Families with Finite
Support.”</span> <em>Computational Statistics</em> 40 (2): 701–21. <a href="https://doi.org/10.1007/s00180-024-01506-0" class="external-link">https://doi.org/10.1007/s00180-024-01506-0</a>.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Juho Piironen, Markus Paasiniemi, Alejandro Catalina, Frank Weber, Osvaldo Martin, Aki Vehtari.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
